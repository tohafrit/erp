package ru.korundm.schedule.importation.process;

import eco.dao.EcoBomComponentService;
import eco.dao.EcoCompanyService;
import org.apache.commons.collections4.CollectionUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Scope;
import org.springframework.stereotype.Component;
import org.springframework.transaction.annotation.Transactional;
import ru.korundm.dao.CompanyService;
import ru.korundm.entity.Company;
import ru.korundm.entity.CompanyType;
import ru.korundm.enumeration.CompanyTypeEnum;

import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;
import java.util.*;
import java.util.stream.Collectors;

import static org.springframework.beans.factory.config.ConfigurableBeanFactory.SCOPE_SINGLETON;
import static org.springframework.transaction.annotation.Propagation.REQUIRES_NEW;
import static ru.korundm.constant.BaseConstant.SQL_DISABLE_FOREIGN_KEY_CHECKS;
import static ru.korundm.constant.BaseConstant.SQL_ENABLE_FOREIGN_KEY_CHECKS;

/**
 * Процесс заполнения таблицы companies
 * @author pakhunov_an
 * Date:   01.08.2020
 */
@Component
@Scope(SCOPE_SINGLETON)
public class CompanyProcess {

    /** Список найденных компаний с таблице CONTRACTOR */
    private static final List<Long> COMPANY_CONTRACTOR_REF =
        List.of(1L, 2370L, 13249L, 4014L, 2570404L, 3865L, 3476L, 2565L, 3631L, 23809L, 2403L, 3472L, 2542L, 2434907L);

    /** Соответствие ОГРН и ИНН */
    private static final Map<String, String> ogrn;
    static {
        Map<String, String> ogrnCopy = new HashMap<>();
        ogrnCopy.put("1024600949867", "4629019412");
        ogrnCopy.put("1022101269123", "2129017646");
        ogrnCopy.put("1057747826740", "7726525811");
        ogrnCopy.put("1037739326646", "7725047200");
        ogrnCopy.put("107746619683", "7725700394");
        ogrnCopy.put("1097847180639", "7819310946");
        ogrnCopy.put("1165040050460", "5040139008");
        ogrnCopy.put("1027700140930", "7735010706");
        ogrnCopy.put("1057735022377", "7735128151");
        ogrnCopy.put("1027739074142", "7713215523");
        ogrnCopy.put("1113256022824", "3255517577");
        ogrnCopy.put("1103332000232", "3305708964");
        ogrnCopy.put("1027701015352", "7701315700");
        ogrnCopy.put("1075012001492", "5012039795");
        ogrnCopy.put("1067847396187", "7814338031");
        ogrnCopy.put("1167746431049", "9701039203");
        ogrnCopy.put("1116234013598", "6234098539");
        ogrnCopy.put("1037841000075", "7819013502");
        ogrnCopy.put("1021202049637", "1217000287");
        ogrnCopy.put("1033231005884", "3254000296");
        ogrnCopy.put("1097746795882", "7723741268");
        ogrnCopy.put("5067847003428", "7813346618");
        ogrnCopy.put("1037735024744", "7735127119");
        ogrnCopy.put("1021603145541", "1657032272");
        ogrnCopy.put("1027810228786", "7826092350");
        ogrnCopy.put("1021801140833", "1826000616");
        ogrnCopy.put("1021801143374", "1831083343");
        ogrnCopy.put("1027806858749", "7813132895");
        ogrnCopy.put("1113256013419", "3254511340");
        ogrnCopy.put("5087746606712", "7723691017");
        ogrnCopy.put("1047796865863", "7743543546");
        ogrnCopy.put("1117746904417", "7728789425");
        ogrnCopy.put("1124011001058", "4007017378");
        ogrnCopy.put("1021603617188", "1660004229");
        ogrnCopy.put("1035006107707", "5031046075");
        ogrnCopy.put("1027700032161", "7713005406");
        ogrnCopy.put("1037730020844", "7730170167");
        ogrnCopy.put("1067746239230", "7720544208");
        ogrnCopy.put("1097847058143", "7802463197");
        ogrnCopy.put("1067847424160", "7813341546");
        ogrnCopy.put("1053600445337", "3666127502");
        ogrnCopy.put("1097847057330", "7813438763");
        ogrnCopy.put("1027739001993", "7731084175");
        ogrnCopy.put("1111832003018", "1832090230");
        ogrnCopy.put("1127746365670", "7723836671");
        ogrnCopy.put("1027700069902", "7710037914");
        ogrnCopy.put("1097746084666", "7703695246");
        ogrnCopy.put("1041628213626", "1659052901");
        ogrnCopy.put("1047731013857", "7731280660");
        ogrnCopy.put("1021200757808", "1200001885");
        ogrnCopy.put("1027739057884", "7719035460");
        ogrnCopy.put("1027802763240", "7805013333");
        ogrnCopy.put("1027809181333", "7815003736");
        ogrnCopy.put("1027739148469", "7736053886");
        ogrnCopy.put("1117746142502", "7735575858");
        ogrnCopy.put("1086623002190", "6623029538");
        ogrnCopy.put("1025100712207", "5110310653");
        ogrnCopy.put("1117847020400", "7813491943");
        ogrnCopy.put("1027801555143", "7802144144");
        ogrnCopy.put("1047717004510", "7717149279");
        ogrnCopy.put("1020202554558", "0274051744");
        ogrnCopy.put("1136319002731", "6319169796");
        ogrnCopy.put("5107746066192", "7735574607");
        ogrnCopy.put("1127746009500", "7728795443");
        ogrnCopy.put("1025001627859", "5013045054");
        ogrnCopy.put("1027810297800", "7809003135");
        ogrnCopy.put("1127746262390", "7728804257");
        ogrnCopy.put("1057749273361", "7717546420");
        ogrnCopy.put("1115261005738", "5261077695");
        ogrnCopy.put("1125022001851", "5022039177");
        ogrnCopy.put("1037710046736", "7710467265");
        ogrnCopy.put("1115321008175", "5321151441");
        ogrnCopy.put("1027739090708", "7731018133");
        ogrnCopy.put("1025201420012", "5244012779");
        ogrnCopy.put("1027739687975", "7709163294");
        ogrnCopy.put("1025203721707", "5262073044");
        ogrnCopy.put("1146685026509", "6685066917");
        ogrnCopy.put("1026701422076", "6731036814");
        ogrnCopy.put("1135050007400", "5050108496");
        ogrnCopy.put("1024001425513", "4026005699");
        ogrnCopy.put("1084202001234", "4202034320");
        ogrnCopy.put("1097746763102", "7720673002");
        ogrnCopy.put("1027806864535", "7813113934");
        ogrnCopy.put("1077017004063", "7017171342");
        ogrnCopy.put("1115543021241", "5505211490");
        ogrnCopy.put("1085543060734", "5505204171");
        ogrnCopy.put("1115543024574", "5506218498");
        ogrnCopy.put("1107746441846", "7743782008");
        ogrnCopy.put("1021301112667", "1325029808");
        ogrnCopy.put("1027800540162", "7805069865");
        ogrnCopy.put("1082902001401", "2902059091");
        ogrnCopy.put("1125835000170", "5835094992");
        ogrnCopy.put("1125835000125", "5835094907");
        ogrnCopy.put("1037700203364", "7721212396");
        ogrnCopy.put("1023402971976", "3443048328");
        ogrnCopy.put("1025700827283", "5753018359");
        ogrnCopy.put("1023901861213", "3900000111");
        ogrnCopy.put("1069847101169", "7805395957");
        ogrnCopy.put("1117746996377", "7728792756");
        ogrnCopy.put("1045802500336", "5835049799");
        ogrnCopy.put("1021603465850", "1659034109");
        ogrnCopy.put("1027739267126", "7713122621");
        ogrnCopy.put("1025005116839", "5040001426");
        ogrnCopy.put("1025005118830", "5040007594");
        ogrnCopy.put("1037700003791", "7708006789");
        ogrnCopy.put("1025005598969", "5043000212");
        ogrnCopy.put("1037700132634", "7719189125");
        ogrnCopy.put("1094703001843", "4703111424");
        ogrnCopy.put("1086229000560", "6229060995");
        ogrnCopy.put("1097746649681", "7722698789");
        ogrnCopy.put("1037843100052", "7825507108");
        ogrnCopy.put("1027601301639", "7612024201");
        ogrnCopy.put("1026201082060", "6229031754");
        ogrnCopy.put("1082902000796", "2902058531");
        ogrnCopy.put("1025005598155", "5043012881");
        ogrnCopy.put("1035100130394", "5116060209");
        ogrnCopy.put("1151690065185", "1660249187");
        ogrnCopy.put("1056154000154", "6154093944");
        ogrnCopy.put("1116154006210", "6154573235");
        ogrnCopy.put("1027301482603", "7303026762");
        ogrnCopy.put("1026604961129", "6670012517");
        ogrnCopy.put("1085261002628", "5261064047");
        ogrnCopy.put("1085543005976", "5506202219");
        ogrnCopy.put("1127746028410", "7715900066");
        ogrnCopy.put("1145074012104", "5074051432");
        ogrnCopy.put("1082902002677", "2902060361");
        ogrnCopy.put("1027739504561", "7724179933");
        ogrnCopy.put("1082468060553", "2462206345");
        ogrnCopy.put("1022201770084", "2225008370");
        ogrnCopy.put("1026102571373", "6154079450");
        ogrnCopy.put("1027739883610", "7722137960");
        ogrnCopy.put("1037739182018", "7707100845");
        ogrnCopy.put("1035802518531", "5835049453");
        ogrnCopy.put("1035007912170", "5040036059");
        ogrnCopy.put("1037700255284", "7704252261");
        ogrnCopy.put("1187746973523", "7704212290");
        ogrnCopy.put("1097746350151", "7718766718");
        ogrnCopy.put("1037700000381", "7729138352");
        ogrnCopy.put("1027802497656", "7804137537");
        ogrnCopy.put("1026403049122", "6453044367");
        ogrnCopy.put("1117746813623", "7734665570");
        ogrnCopy.put("1027810296326", "7812013743");
        ogrnCopy.put("1027739544513", "7722016370");
        ogrnCopy.put("1037700239037", "7722239785");
        ogrnCopy.put("1097746587950", "7705898594");
        ogrnCopy.put("1097746061511", "7725663992");
        ogrnCopy.put("1027700367837", "7729026264");
        ogrnCopy.put("1089847379192", "7816451040");
        ogrnCopy.put("1027739020968", "7706049240");
        ogrnCopy.put("1022900843437", "2902044923");
        ogrnCopy.put("1057811585380", "7802328180");
        ogrnCopy.put("1107746187999", "7724739790");
        ogrnCopy.put("1027809186998", "7815002718");
        ogrnCopy.put("1037739536526", "7731041333");
        ogrnCopy.put("1047796027883", "7709526445");
        ogrnCopy.put("1027739761664", "7729133900");
        ogrnCopy.put("1027800507932", "7801096875");
        ogrnCopy.put("1027739042187", "7729043527");
        ogrnCopy.put("1097746755545", "7714794802");
        ogrnCopy.put("1027700115453", "7702157005");
        ogrnCopy.put("1037739771508", "7709014172");
        ogrnCopy.put("1047796218084", "7713523750");
        ogrnCopy.put("1027700456024", "7725075060");
        ogrnCopy.put("1115040007642", "5040108440");
        ogrnCopy.put("1077758355146", "7709750743");
        ogrnCopy.put("1027700019819", "7727133398");
        ogrnCopy.put("1027806064571", "7811075899");
        ogrnCopy.put("1023202737942", "3234024443");
        ogrnCopy.put("1067746316769", "7714637870");
        ogrnCopy.put("1037863003310", "7839002026");
        ogrnCopy.put("1027700037705", "7722009140");
        ogrnCopy.put("1097746825890", "7703712646");
        ogrnCopy.put("1117847336793", "7813509380");
        ogrnCopy.put("1027739544502", "7719198313");
        ogrnCopy.put("1027700189582", "7704039670");
        ogrnCopy.put("1037700089052", "7719079370");
        ogrnCopy.put("1077847571669", "7813389280");
        ogrnCopy.put("1027802486205", "7804068058");
        ogrnCopy.put("1027700459280", "7720003600");
        ogrnCopy.put("1027739104810", "7707009025");
        ogrnCopy.put("1027700581897", "7722024194");
        ogrnCopy.put("1027739789990", "7719155535");
        ogrnCopy.put("1127847387260", "7801579632");
        ogrnCopy.put("1037816019713", "7806121490");
        ogrnCopy.put("1037821072629", "7810290702");
        ogrnCopy.put("1027700461909", "7715091545");
        ogrnCopy.put("1089847196427", "7816441972");
        ogrnCopy.put("1023202740736", "3201005519");
        ogrnCopy.put("1077847617363", "7805441120");
        ogrnCopy.put("1037739529893", "7735064324");
        ogrnCopy.put("1027739423172", "7719044994");
        ogrnCopy.put("5077746450733", "7731564982");
        ogrnCopy.put("1037700058824", "7710336512");
        ogrnCopy.put("1027739083921", "7735040690");
        ogrnCopy.put("1027700272247", "7723009826");
        ogrnCopy.put("1057749394878", "7705704545");
        ogrnCopy.put("1026604962427", "6660123850");
        ogrnCopy.put("1025001418749", "5010008907");
        ogrnCopy.put("1067746336085", "7719582826");
        ogrnCopy.put("1027802486502", "7804060845");
        ogrnCopy.put("1027804885371", "7810102395");
        ogrnCopy.put("1067761846932", "7705772418");
        ogrnCopy.put("1037728039128", "7728297350");
        ogrnCopy.put("1027739259008", "7713019991");
        ogrnCopy.put("1027804848543", "7810223583");
        ogrnCopy.put("1027801534485", "7802002037");
        ogrnCopy.put("1097746837341", "7713698567");
        ogrnCopy.put("1026801360244", "6831012207");
        ogrnCopy.put("5077746460380", "7729571904");
        ogrnCopy.put("1127746274061", "7736642031");
        ogrnCopy.put("1023101640540", "3123040489");
        ogrnCopy.put("1077759103542", "7733618993");
        ogrnCopy.put("1037709037398", "7709420199");
        ogrnCopy.put("1047796106269", "7723505528");
        ogrnCopy.put("1117847241654", "7802753763");
        ogrnCopy.put("1025901367095", "5906038316");
        ogrnCopy.put("1053600445227", "3662103003");
        ogrnCopy.put("5087746599980", "7718736985");
        ogrnCopy.put("1035009561795", "5047039764");
        ogrnCopy.put("1027804917612", "7810911290");
        ogrnCopy.put("1037739864370", "7713507325");
        ogrnCopy.put("1047796835866", "7735507784");
        ogrnCopy.put("1027700271807", "7729108750");
        ogrnCopy.put("1076731012346", "6731063247");
        ogrnCopy.put("1057746267204", "7735510040");
        ogrnCopy.put("1027804902344", "7810943817");
        ogrnCopy.put("1026102905740", "6164060384");
        ogrnCopy.put("1027804177741", "7806007653");
        ogrnCopy.put("1037739187892", "7714009178");
        ogrnCopy.put("1027739103446", "7701175562");
        ogrnCopy.put("1027739789461", "7731163035");
        ogrnCopy.put("1025203037078", "5260900066");
        ogrnCopy.put("304503208400010", "503203403438");
        ogrnCopy.put("313503221800027", "503203403438");
        ogrnCopy.put("304770000277937", "771800039041");
        ogrnCopy.put("305325532100030", "325500178112");
        ogrnCopy.put("317505000038125", "501808349285");
        ogrnCopy.put("311010518700031", "010517427187");
        ogrnCopy.put("311010525000240", "010517427187");
        ogrnCopy.put("1026300768614", "6312033891");
        ogrnCopy.put("1035000009417", "5043014134");
        ogrnCopy.put("1027739615584", "7735041133");
        ogrnCopy.put("1026103165241", "6163027810");
        ogrnCopy.put("1037722018487", "7722288207");
        ogrnCopy.put("1107746619683", "7725700394");
        ogrnCopy.put("1097847146748", "7807343496");
        ogrnCopy.put("1027810255208", "7830002173");
        ogrnCopy.put("1066166001813", "6166055693");
        ogrnCopy.put("1027700137739", "7701015689");
        ogrnCopy.put("1022300631902", "2302008440");
        ogrnCopy.put("1120280004888", "0275076276");
        ogrnCopy.put("1037704005041", "7704252960");
        ogrnCopy.put("1116195013934", "6163111477");
        ogrnCopy.put("1027700019632", "7727062154");
        ogrnCopy.put("1037800086345", "7801236681");
        ogrnCopy.put("1022501797064", "2537009643");
        ogrnCopy.put("1025202396790", "5257008145");
        ogrnCopy.put("1087415002168", "7415061109");
        ogrnCopy.put("1027700118984", "7712040285");
        ogrnCopy.put("1103926012266", "3902800272");
        ogrnCopy.put("1025001202544", "5008000322");
        ogrnCopy.put("1024701241322", "4705006552");
        ogrnCopy.put("1024701328838", "4706002374");
        ogrnCopy.put("1026901811881", "6913005680");
        ogrnCopy.put("1027801538610", "7802053803");
        ogrnCopy.put("1023301951397", "3305004083");
        ogrnCopy.put("1026600929288", "6666003380");
        ogrnCopy.put("1037739097747", "7735030967");
        ogrnCopy.put("1031644204514", "1648013442");
        ogrnCopy.put("1027810341228", "7826159171");
        ogrnCopy.put("1027809192333", "7825347630");
        ogrnCopy.put("1020502132353", "0545002503");
        ogrnCopy.put("1047601614390", "7610063043");
        ogrnCopy.put("1027739010342", "7712098655");
        ogrnCopy.put("1033302200458", "3305004397");
        ogrnCopy.put("1022700523724", "2703019760");
        ogrnCopy.put("1025005118863", "5040043401");
        ogrnCopy.put("5067847016782", "7842335610");
        ogrnCopy.put("1052306488057", "2311085593");
        ogrnCopy.put("1027739584146", "7705410513");
        ogrnCopy.put("1063667000495", "3661033667");
        ogrnCopy.put("1023301951177", "3305004421");
        ogrnCopy.put("1027806857572", "7813045025");
        ogrnCopy.put("1027713010841", "7713357824");
        ogrnCopy.put("1075013003372", "5013055775");
        ogrnCopy.put("1027722009479", "7722272768");
        ogrnCopy.put("1027800508537", "7728156800");
        ogrnCopy.put("1025901364708", "5906009273");
        ogrnCopy.put("1025300988085", "5320002221");
        ogrnCopy.put("1033400265733", "3443055050");
        ogrnCopy.put("1114345026784", "4345309407");
        ogrnCopy.put("1097746735481", "7715784155");
        ogrnCopy.put("1025402462172", "5406236976");
        ogrnCopy.put("1037700085983", "7731168273");
        ogrnCopy.put("1025401904307", "5405108153");
        ogrnCopy.put("1027739073339", "7718016698");
        ogrnCopy.put("1025400510827", "5401199015");
        ogrnCopy.put("1127847050385", "7811511866");
        ogrnCopy.put("1035300271379", "5321091136");
        ogrnCopy.put("1127746706801", "7709911253");
        ogrnCopy.put("1027806868495", "7813105965");
        ogrnCopy.put("1027700557763", "7714016680");
        ogrnCopy.put("1025300800579", "5321031176");
        ogrnCopy.put("1025201636877", "5223004199");
        ogrnCopy.put("1027806868506", "7813045057");
        ogrnCopy.put("1025201419781", "5244012761");
        ogrnCopy.put("1026201102850", "6230005886");
        ogrnCopy.put("1115836009255", "5836649358");
        ogrnCopy.put("1027700499970", "7735111366");
        ogrnCopy.put("1025006039046", "5046057591");
        ogrnCopy.put("1027700436664", "7722014421");
        ogrnCopy.put("1027810239555", "7809015518");
        ogrnCopy.put("1021300661425", "1308038496");
        ogrnCopy.put("1022501799858", "2537015534");
        ogrnCopy.put("1175029015457", "5029221971");
        ogrnCopy.put("1023601542546", "3665009866");
        ogrnCopy.put("1022200804504", "2209004000");
        ogrnCopy.put("1026201260447", "6231006875");
        ogrnCopy.put("1021800992124", "1827013914");
        ogrnCopy.put("1036719800281", "6726009364");
        ogrnCopy.put("1022800524493", "2801018211");
        ogrnCopy.put("1027810275657", "7812039798");
        ogrnCopy.put("1023301951045", "3305016642");
        ogrnCopy.put("1063667253528", "3661036308");
        ogrnCopy.put("1026701430238", "6731017748");
        ogrnCopy.put("1027806871674", "7813046950");
        ogrnCopy.put("1025204412298", "5263008707");
        ogrnCopy.put("1056882340173", "6829014768");
        ogrnCopy.put("1027739492978", "7719014012");
        ogrnCopy.put("1066829050859", "6829024766");
        ogrnCopy.put("1056882352119", "6829015472");
        ogrnCopy.put("1037000157611", "7017080945");
        ogrnCopy.put("1027100517718", "7103016372");
        ogrnCopy.put("1026600930630", "6612011546");
        ogrnCopy.put("1115261008895", "5261079163");
        ogrnCopy.put("1085259003664", "5259075468");
        ogrnCopy.put("1025007067612", "5052009116");
        ogrnCopy.put("1027804858146", "7810240719");
        ogrnCopy.put("1027804865505", "7810215381");
        ogrnCopy.put("1022101630561", "2122000604");
        ogrnCopy.put("1025801364390", "5835025149");
        ogrnCopy.put("1027810260136", "7812018283");
        ogrnCopy.put("1020501999858", "0542000272");
        ogrnCopy.put("1023601610504", "3650001159");
        ogrnCopy.put("1021606352844", "1642002557");
        ogrnCopy.put("1027600980990", "7601000086");
        ogrnCopy.put("1027600981847", "7601001080");
        ogrnCopy.put("1027700321901", "7726019607");
        ogrnCopy.put("1023302153115", "3307011706");
        ogrnCopy.put("1067746240210", "7706607880");
        ogrnCopy.put("1025202607473", "5258000011");
        ogrnCopy.put("1027802713773", "7805034277");
        ogrnCopy.put("1027801525773", "7802106117");
        ogrnCopy.put("1147746300690", "7722838242");
        ogrnCopy.put("1067746623372", "7733569055");
        ogrnCopy.put("5137746067179", "7723889433");
        ogrnCopy.put("1097746364320", "7730611767");
        ogrnCopy.put("1127746608230", "7728815474");
        ogrnCopy.put("1165018054530", "5018186098");
        ogrnCopy.put("1086671013043", "6671267564");
        ogrnCopy.put("1097746158795", "7709827481");
        ogrnCopy.put("1025003918180", "5031051251");
        ogrnCopy.put("1087746992398", "7720627013");
        ogrnCopy.put("1123332001704", "3305715383");
        ogrnCopy.put("1157746599471", "7720307983");
        ogrnCopy.put("1037843034008", "7825083096");
        ogrnCopy.put("1023601580045", "3662055600");
        ogrnCopy.put("1137746834158", "7703796822");
        ogrnCopy.put("1062310010388", "2310112276");
        ogrnCopy.put("1177746272659", "9729065884");
        ogrnCopy.put("1067746681155", "7721557513");
        ogrnCopy.put("1127746430778", "7733804414");
        ogrnCopy.put("1117746969977", "7703757990");
        ogrnCopy.put("1169658092856", "6671051653");
        ogrnCopy.put("1147748030154", "7717803967");
        ogrnCopy.put("1157847144652", "7802514691");
        ogrnCopy.put("1097746646260", "7733714785");
        ogrnCopy.put("1077746153650", "7709721453");
        ogrnCopy.put("1157847111124", "7801276959");
        ogrnCopy.put("1037739248140", "7705403996");
        ogrnCopy.put("1057748573585", "7705690941");
        ogrnCopy.put("1097746006346", "7708695056");
        ogrnCopy.put("1077746708786", "7724609706");
        ogrnCopy.put("1137746042598", "7714895494");
        ogrnCopy.put("5077746344110", "7733600227");
        ogrnCopy.put("1055000500598", "5001049431");
        ogrnCopy.put("1117746132888", "7727742209");
        ogrnCopy.put("1127746141401", "7714866060");
        ogrnCopy.put("1147847334865", "7842528066");
        ogrnCopy.put("1117847315850", "7814507829");
        ogrnCopy.put("5157746205645", "7716813105");
        ogrnCopy.put("5077746524983", "7727609831");
        ogrnCopy.put("1147746113976", "7717775639");
        ogrnCopy.put("5147746328813", "7716789406");
        ogrnCopy.put("1137746883394", "7703797625");
        ogrnCopy.put("1127746385425", "7720750874");
        ogrnCopy.put("1159102087980", "9102181994");
        ogrnCopy.put("1047820002240", "7813197194");
        ogrnCopy.put("1037828022583", "7813108451");
        ogrnCopy.put("1047833022302", "7838025091");
        ogrnCopy.put("1127746556893", "7707780968");
        ogrnCopy.put("1147847038437", "7802850125");
        ogrnCopy.put("1097746855436", "7718790830");
        ogrnCopy.put("1177746923078", "7719471918");
        ogrnCopy.put("1117746846799", "7710899547");
        ogrnCopy.put("1057813173835", "7813336306");
        ogrnCopy.put("1027739846859", "7725015470");
        ogrnCopy.put("1127746577760", "7718895449");
        ogrnCopy.put("1147746120983", "7743915875");
        ogrnCopy.put("1077761511816", "7743663561");
        ogrnCopy.put("1097746524347", "7735562489");
        ogrnCopy.put("1157847282119", "7802536470");
        ogrnCopy.put("1127747046118", "7719825204");
        ogrnCopy.put("5147746322752", "7709967200");
        ogrnCopy.put("1027739801099", "7724197756");
        ogrnCopy.put("1087746480612", "7733651334");
        ogrnCopy.put("5117746035413", "7728793929");
        ogrnCopy.put("5167746097954", "7723478024");
        ogrnCopy.put("1047796635457", "7733527898");
        ogrnCopy.put("1147746657079", "7727836753");
        ogrnCopy.put("1107746886532", "7725706935");
        ogrnCopy.put("5147746130626", "7722855745");
        ogrnCopy.put("1035000900934", "5003039260");
        ogrnCopy.put("1037739177211", "7735021120");
        ogrnCopy.put("1027708015334", "7708208601");
        ogrnCopy.put("1047808007048", "7805295399");
        ogrnCopy.put("1057746560970", "7725535824");
        ogrnCopy.put("1037821017442", "7810240910");
        ogrnCopy.put("1037705031418", "7705496101");
        ogrnCopy.put("1037739423039", "7723200759");
        ogrnCopy.put("1117746524532", "7728776948");
        ogrnCopy.put("1054639119457", "4632056750");
        ogrnCopy.put("1047855128727", "7838308798");
        ogrnCopy.put("1045005020653", "5027104983");
        ogrnCopy.put("1067746578041", "7733568069");
        ogrnCopy.put("1037739956011", "7718500436");
        ogrnCopy.put("1157847092182", "7807072768");
        ogrnCopy.put("1147746116649", "7725818519");
        ogrnCopy.put("5077746935635", "7735530913");
        ogrnCopy.put("1157746209323", "7733225350");
        ogrnCopy.put("1035011803529", "5039007720");
        ogrnCopy.put("1095018001242", "5018134822");
        ogrnCopy.put("1167746434756", "7721486510");
        ogrnCopy.put("1127847094726", "7802779994");
        ogrnCopy.put("1027739340221", "7709375732");
        ogrnCopy.put("1127746114539", "7704801497");
        ogrnCopy.put("1097746716550", "7713695710");
        ogrnCopy.put("1027739244741", "7704217370");
        ogrnCopy.put("1037717007580", "7717140607");
        ogrnCopy.put("1037825054728", "7811143524");
        ogrnCopy.put("1125012006030", "5012074768");
        ogrnCopy.put("5137746042320", "7713779262");
        ogrnCopy.put("1157746020662", "7734344745");
        ogrnCopy.put("1025901221334", "5905220812");
        ogrnCopy.put("1021801503855", "1833015839");
        ogrnCopy.put("1097746265319", "7718762495");
        ogrnCopy.put("1037702016879", "7702349300");
        ogrnCopy.put("1137847386148", "7810763557");
        ogrnCopy.put("1077764790663", "7718683229");
        ogrnCopy.put("1085027013400", "5027141583");
        ogrnCopy.put("1107746071784", "7743769102");
        ogrnCopy.put("1027739125655", "7704199258");
        ogrnCopy.put("1137746499956", "7704837415");
        ogrnCopy.put("1147746413594", "7722840925");
        ogrnCopy.put("1165027051683", "5027237750");
        ogrnCopy.put("1057749462605", "7728567951");
        ogrnCopy.put("5067746339700", "7705749433");
        ogrnCopy.put("1067746462981", "7720549365");
        ogrnCopy.put("1127746142809", "7716710501");
        ogrnCopy.put("1157746024930", "7716117612");
        ogrnCopy.put("1097746347137", "7722688460");
        ogrnCopy.put("1097746789601", "7702721207");
        ogrnCopy.put("5077746552681", "7731565680");
        ogrnCopy.put("1067761216050", "7709716990");
        ogrnCopy.put("1107746613413", "7743788641");
        ogrnCopy.put("1079847145047", "7842374480");
        ogrnCopy.put("1137746399801", "7721793895");
        ogrnCopy.put("1077761439403", "7743663258");
        ogrnCopy.put("1115047009868", "5047125237");
        ogrnCopy.put("1127746327752", "7743851251");
        ogrnCopy.put("1147847013247", "7814598872");
        ogrnCopy.put("5087746251038", "7743710236");
        ogrnCopy.put("1027800551888", "7801223844");
        ogrnCopy.put("1057748348470", "7701618782");
        ogrnCopy.put("1027722013472", "7722274003");
        ogrnCopy.put("1057748985172", "7722561047");
        ogrnCopy.put("1127847504432", "7805602321");
        ogrnCopy.put("1117746689653", "7731412468");
        ogrnCopy.put("1127746127080", "7716710004");
        ogrnCopy.put("1037800082902", "7801235649");
        ogrnCopy.put("1037851007523", "7826159936");
        ogrnCopy.put("1161690064117", "1655350368");
        ogrnCopy.put("1077847501577", "7810482980");
        ogrnCopy.put("1027739440211", "7720147017");
        ogrnCopy.put("1027739020759", "7720134018");
        ogrnCopy.put("1095018004290", "5018137492");
        ogrnCopy.put("1135040008102", "5040127034");
        ogrnCopy.put("1165018050680", "5018183467");
        ogrnCopy.put("1085050000232", "5050068596");
        ogrnCopy.put("1077758938399", "7701739064");
        ogrnCopy.put("1144313000150", "4324008180");
        ogrnCopy.put("1137746288008", "7708786240");
        ogrnCopy.put("1095003005679", "5003074994");
        ogrnCopy.put("1175275023934", "5262347552");
        ogrnCopy.put("1165252050842", "5231006545");
        ogrnCopy.put("1101690029484", "1658117426");
        ogrnCopy.put("1117746449864", "7735578471");
        ogrnCopy.put("1037735012457", "7735122689");
        ogrnCopy.put("1187746364156", "7720419006");
        ogrnCopy.put("1077759337150", "7735532685");
        ogrnCopy.put("1117746552494", "7735578947");
        ogrnCopy.put("1167746505552", "7743157075");
        ogrnCopy.put("1107746573417", "7743787091");
        ogrnCopy.put("1117847138166", "7805550962");
        ogrnCopy.put("1027700299736", "7729185232");
        ogrnCopy.put("5147746261075", "7735605936");
        ogrnCopy.put("1026201076725", "6231007928");
        ogrnCopy.put("1087746849970", "7727657240");
        ogrnCopy.put("1027726004063", "7726319858");
        ogrnCopy.put("1027804609788", "7807025366");
        ogrnCopy.put("1097847193652", "7811440397");
        ogrnCopy.put("1035205279273", "5259038804");
        ogrnCopy.put("1065047000182", "5008040124");
        ogrnCopy.put("1037733034844", "7733176449");
        ogrnCopy.put("1037835014469", "7816197682");
        ogrnCopy.put("1087746170775", "7710705897");
        ogrnCopy.put("1157746061813", "7709447842");
        ogrnCopy.put("1067746801638", "7709689016");
        ogrnCopy.put("1075027010541", "5027124387");
        ogrnCopy.put("1037828000660", "7813121149");
        ogrnCopy.put("1026102898315", "6161022983");
        ogrnCopy.put("1027739721250", "7706265403");
        ogrnCopy.put("1047855091987", "7810008434");
        ogrnCopy.put("1025202272556", "5256002172");
        ogrnCopy.put("1025002878812", "5024043193");
        ogrnCopy.put("1097847048287", "7813438026");
        ogrnCopy.put("1045003352107", "5018092523");
        ogrnCopy.put("1107746099735", "7722709208");
        ogrnCopy.put("1025002689524", "5021002270");
        ogrnCopy.put("1097847315114", "7810569180");
        ogrnCopy.put("1085018000726", "5018124510");
        ogrnCopy.put("5077746302134", "7715640097");
        ogrnCopy.put("1117746577629", "7703748508");
        ogrnCopy.put("1054700290886", "4706022275");
        ogrnCopy.put("1127847065334", "7813525631");
        ogrnCopy.put("1107847196005", "7801522403");
        ogrnCopy.put("1027739885733", "7735106616");
        ogrnCopy.put("1157746034820", "7709447183");
        ogrnCopy.put("1117746590081", "7718854925");
        ogrnCopy.put("1157746990060", "7743125309");
        ogrnCopy.put("1097746590985", "7728712084");
        ogrnCopy.put("1087746148962", "7719667861");
        ogrnCopy.put("1127747170198", "7720766899");
        ogrnCopy.put("1107746589500", "7716668345");
        ogrnCopy.put("1057746026293", "7709587840");
        ogrnCopy.put("1025003914858", "5031024868");
        ogrnCopy.put("1167847121750", "7814642835");
        ogrnCopy.put("1095018005345", "5018138440");
        ogrnCopy.put("1027739120100", "7702297436");
        ogrnCopy.put("1027801584304", "7802156140");
        ogrnCopy.put("1035009558561", "5047010733");
        ogrnCopy.put("5157746076440", "7728322239");
        ogrnCopy.put("1127746465934", "7731428651");
        ogrnCopy.put("1127746244229", "7720746349");
        ogrnCopy.put("5147746286848", "7731483099");
        ogrnCopy.put("1127746556882", "7707780950");
        ogrnCopy.put("1127746555606", "7731430234");
        ogrnCopy.put("1127746115595", "7701948318");
        ogrnCopy.put("1095024005812", "5024106950");
        ogrnCopy.put("1157847068246", "7814186004");
        ogrnCopy.put("1099847030612", "7810574045");
        ogrnCopy.put("1097746645897", "7705900331");
        ogrnCopy.put("1127746099502", "7726691488");
        ogrnCopy.put("1085009001263", "5009062723");
        ogrnCopy.put("1113668028858", "3662166719");
        ogrnCopy.put("1057811045467", "7841316774");
        ogrnCopy.put("1097746185371", "7710748690");
        ogrnCopy.put("1067746829336", "7715609700");
        ogrnCopy.put("1137847207090", "7814574455");
        ogrnCopy.put("1099847007864", "7814453757");
        ogrnCopy.put("1097746089407", "7722680051");
        ogrnCopy.put("1077847479346", "7841365242");
        ogrnCopy.put("1117746975610", "7724814590");
        ogrnCopy.put("1107847390463", "7820323259");
        ogrnCopy.put("1127847061320", "7806470678");
        ogrnCopy.put("1117746733961", "7722756504");
        ogrnCopy.put("1136229001270", "6229068962");
        ogrnCopy.put("1107847230721", "7838446766");
        ogrnCopy.put("1125029008280", "5029166199");
        ogrnCopy.put("1067746603176", "7734543300");
        ogrnCopy.put("1027739753095", "7727145989");
        ogrnCopy.put("1117746344858", "7719778378");
        ogrnCopy.put("1106671018200", "6671333190");
        ogrnCopy.put("1147847399028", "7814628975");
        ogrnCopy.put("1116952055153", "6950140053");
        ogrnCopy.put("1147746080448", "7731464233");
        ogrnCopy.put("1137746289746", "7724871140");
        ogrnCopy.put("5087746695230", "7718739168");
        ogrnCopy.put("1127747215133", "7724856208");
        ogrnCopy.put("1177746406584", "7730234438");
        ogrnCopy.put("1147746227595", "7730702809");
        ogrnCopy.put("1075404017193", "5404330123");
        ogrnCopy.put("1127746114660", "7725748389");
        ogrnCopy.put("1037739154870", "5044031157");
        ogrnCopy.put("1147748148206", "7716049296");
        ogrnCopy.put("1107746879525", "7718824350");
        ogrnCopy.put("1157746400778", "7733233055");
        ogrnCopy.put("1047706012056", "7706404350");
        ogrnCopy.put("1129847007290", "7820331010");
        ogrnCopy.put("1037821016606", "7810151850");
        ogrnCopy.put("1037825054486", "7811143274");
        ogrnCopy.put("1097746589643", "7720668316");
        ogrnCopy.put("1127747014493", "7724849296");
        ogrnCopy.put("1067759441067", "7719610128");
        ogrnCopy.put("1037739381613", "7714039694");
        ogrnCopy.put("1097746152899", "7735558644");
        ogrnCopy.put("1127746330799", "7734679029");
        ogrnCopy.put("1097746262547", "7715758042");
        ogrnCopy.put("1157746005306", "7751000705");
        ogrnCopy.put("1125003000297", "5003098956");
        ogrnCopy.put("1136733004231", "6725018655");
        ogrnCopy.put("1037739069862", "7735051854");
        ogrnCopy.put("5157746158191", "7743132306");
        ogrnCopy.put("1117847494820", "7814518161");
        ogrnCopy.put("1157746324658", "7714335750");
        ogrnCopy.put("5137746216768", "7704853382");
        ogrnCopy.put("1097746303643", "7701839245");
        ogrnCopy.put("1097847153788", "7814439103");
        ogrnCopy.put("1133023001462", "3023006075");
        ogrnCopy.put("1167746473168", "7743155776");
        ogrnCopy.put("1157847394682", "7805337634");
        ogrnCopy.put("1061838018923", "1838000219");
        ogrnCopy.put("1117847457826", "7841453851");
        ogrnCopy.put("1137746368319", "7716744067");
        ogrnCopy.put("1107746575430", "7713711063");
        ogrnCopy.put("1037739607619", "7705309016");
        ogrnCopy.put("1115047016732", "5008057431");
        ogrnCopy.put("1147746145337", "7718968577");
        ogrnCopy.put("1077604028919", "7604118921");
        ogrnCopy.put("1107746182950", "7715800424");
        ogrnCopy.put("1127746409340", "7707776898");
        ogrnCopy.put("1037728044485", "7728299999");
        ogrnCopy.put("1117746937461", "7721742065");
        ogrnCopy.put("1157847063373", "7810339210");
        ogrnCopy.put("1186658012826", "6686103777");
        ogrnCopy.put("1077847418054", "7841362450");
        ogrnCopy.put("1157847002774", "7806078196");
        ogrnCopy.put("1097746598289", "7723731615");
        ogrnCopy.put("1021200780028", "1215034107");
        ogrnCopy.put("5167746369060", "7720361170");
        ogrnCopy.put("1107746603590", "7706741388");
        ogrnCopy.put("1067757924948", "7728597498");
        ogrnCopy.put("1117746989293", "7730656574");
        ogrnCopy.put("1095252001382", "5208004797");
        ogrnCopy.put("1057749709380", "7743581260");
        ogrnCopy.put("1167746422491", "7716823801");
        ogrnCopy.put("1107746350645", "7715808737");
        ogrnCopy.put("1167746677581", "7722370155");
        ogrnCopy.put("1127747025350", "7733817886");
        ogrnCopy.put("1095040001121", "5040089815");
        ogrnCopy.put("1137746607151", "7724882529");
        ogrnCopy.put("1027700432650", "7706202481");
        ogrnCopy.put("1037821099942", "7810297560");
        ogrnCopy.put("1065029131133", "5029096914");
        ogrnCopy.put("1037739174934", "7702331687");
        ogrnCopy.put("1033302205860", "5263025766");
        ogrnCopy.put("1127746123713", "7720742584");
        ogrnCopy.put("1107746719849", "7743791940");
        ogrnCopy.put("1027700489464", "7701104804");
        ogrnCopy.put("1107847125297", "7811462182");
        ogrnCopy.put("1055230019206", "5257072084");
        ogrnCopy.put("1127746237080", "7720746123");
        ogrnCopy.put("1097746810765", "7736611668");
        ogrnCopy.put("1177847389026", "7804611348");
        ogrnCopy.put("1155038002460", "5038112560");
        ogrnCopy.put("1137847508534", "7805639924");
        ogrnCopy.put("1107746538635", "7720690368");
        ogrnCopy.put("1127747202945", "7730676669");
        ogrnCopy.put("1157847027337", "7805304621");
        ogrnCopy.put("1167746639466", "7719451647");
        ogrnCopy.put("1165027060153", "5027245984");
        ogrnCopy.put("1025002688776", "5021009934");
        ogrnCopy.put("1111690048414", "1657107827");
        ogrnCopy.put("5067847459950", "7813358959");
        ogrnCopy.put("1107746274680", "7701872588");
        ogrnCopy.put("1041800258444", "1831096455");
        ogrnCopy.put("1107746005113", "7710861159");
        ogrnCopy.put("1077763462457", "7718679078");
        ogrnCopy.put("1087847024363", "7810540857");
        ogrnCopy.put("1027739102522", "7727159029");
        ogrnCopy.put("1037739888515", "7704502296");
        ogrnCopy.put("1157746583389", "7725278630");
        ogrnCopy.put("5117746027966", "7722764142");
        ogrnCopy.put("1167847072370", "7816316876");
        ogrnCopy.put("1095042004881", "5042109320");
        ogrnCopy.put("1025002047465", "5018067527");
        ogrnCopy.put("1117746811599", "7722758646");
        ogrnCopy.put("1037700052235", "7724203713");
        ogrnCopy.put("5117746011940", "7715895793");
        ogrnCopy.put("1107746055823", "7701864410");
        ogrnCopy.put("1167847285165", "7839068066");
        ogrnCopy.put("1027802501000", "7804050438");
        ogrnCopy.put("1127746251940", "7724829003");
        ogrnCopy.put("1097746593383", "7717659865");
        ogrnCopy.put("1026701431360", "6731006231");
        ogrnCopy.put("1026402660250", "6452000776");
        ogrnCopy.put("1067746918557", "7720559540");
        ogrnCopy.put("1023402010390", "3435033141");
        ogrnCopy.put("1025002026323", "5018012101");
        ogrnCopy.put("1027000902114", "7018001061");
        ogrnCopy.put("1027700504413", "7701025126");
        ogrnCopy.put("1022601226592", "2626000057");
        ogrnCopy.put("1025801015822", "5829060184");
        ogrnCopy.put("1027804862128", "7810113372");
        ogrnCopy.put("5147746434501", "7720834500");
        ogrnCopy.put("1175074007283", "5036167316");
        ogrnCopy.put("1087746062656", "7724647028");
        ogrnCopy.put("1027739824958", "7727168520");
        ogrnCopy.put("1105024005261", "5024114278");
        ogrnCopy.put("1127746763275", "7743864606");
        ogrnCopy.put("1022502117505", "2539008807");
        ogrnCopy.put("1027801525608", "7802030605");
        ogrnCopy.put("1037740000649", "7740000090");
        ogrnCopy.put("1025203563879", "5261001745");
        ogrnCopy.put("1027100517256", "7103028233");
        ogrnCopy.put("1025900906349", "5904000395");
        ogrnCopy.put("1022601930537", "2635000092");
        ogrnCopy.put("1025005324123", "5042000530");
        ogrnCopy.put("1026801225296", "6829000109");
        ogrnCopy.put("1025201335994", "5243001887");
        ogrnCopy.put("1026201077572", "6229004711");
        ogrnCopy.put("1027739475279", "7728113806");
        ogrnCopy.put("1037800040794", "7801047839");
        ogrnCopy.put("1152651024261", "2623026089");
        ogrnCopy.put("1027700384909", "7727086772");
        ogrnCopy.put("1026600932566", "6612001971");
        ogrnCopy.put("1027739547164", "7718016747");
        ogrnCopy.put("1037700091736", "7720090314");
        ogrnCopy.put("1026940508473", "6902006770");
        ogrnCopy.put("1030204113202", "0275001249");
        ogrnCopy.put("1035008856321", "5044000110");
        ogrnCopy.put("1027700464615", "7725033623");
        ogrnCopy.put("1027700227720", "7714037739");
        ogrnCopy.put("1027806858298", "7813046170");
        ogrnCopy.put("1024000628145", "4007000448");
        ogrnCopy.put("1024001180631", "4026000147");
        ogrnCopy.put("1027804905303", "7810213747");
        ogrnCopy.put("1024001179509", "4026000161");
        ogrnCopy.put("1037739350857", "7705032903");
        ogrnCopy.put("1025001414976", "5010004050");
        ogrnCopy.put("1027806858155", "7813046188");
        ogrnCopy.put("1037739290676", "7704007157");
        ogrnCopy.put("1027801578705", "7802030669");
        ogrnCopy.put("1026900546969", "6905000417");
        ogrnCopy.put("1027739631479", "7726057948");
        ogrnCopy.put("1027739713341", "7715005835");
        ogrnCopy.put("1025400528482", "5401102256");
        ogrnCopy.put("1023601550466", "3661002940");
        ogrnCopy.put("1025006175644", "5047003253");
        ogrnCopy.put("1027739552642", "7728171283");
        ogrnCopy.put("1026801224119", "6829000050");
        ogrnCopy.put("1025801203780", "5835013312");
        ogrnCopy.put("1027400661650", "7405000428");
        ogrnCopy.put("1027739219980", "7722019765");
        ogrnCopy.put("1027401350932", "7423000572");
        ogrnCopy.put("1025202199791", "5254001230");
        ogrnCopy.put("1027802723464", "7805085828");
        ogrnCopy.put("1027808756370", "7817013970");
        ogrnCopy.put("1025203569203", "5261000011");
        ogrnCopy.put("1022701199894", "2700000049");
        ogrnCopy.put("1027739265784", "7728145452");
        ogrnCopy.put("1027739006151", "7723096829");
        ogrnCopy.put("1027810220404", "7809027400");
        ogrnCopy.put("1025501178636", "5505000153");
        ogrnCopy.put("1027739386465", "7735067477");
        ogrnCopy.put("1027700493358", "7728056266");
        ogrnCopy.put("1025202608738", "5258000163");
        ogrnCopy.put("1027739411402", "7715027275");
        ogrnCopy.put("1026401828034", "6444001487");
        ogrnCopy.put("1035006109170", "5031007340");
        ogrnCopy.put("1067328003027", "7303026811");
        ogrn = Map.copyOf(ogrnCopy);
    }

    @PersistenceContext
    private EntityManager em;

    @Autowired
    private CompanyService companyService;

    @Autowired
    private EcoCompanyService ecoCompanyService;

    @Autowired
    private EcoBomComponentService ecoBomComponentService;

    @Transactional(propagation = REQUIRES_NEW)
    public void schedule() {
        em.createNativeQuery(SQL_DISABLE_FOREIGN_KEY_CHECKS).executeUpdate();
        em.createQuery("DELETE FROM Company").executeUpdate();
        em.createQuery("DELETE FROM CompanyType").executeUpdate();

        // Таблица COMPANY
        List<Company> companyList = ecoCompanyService.getAll().stream().map(ecoEntity -> {
            Company entity = new Company();
            entity.setId(ecoEntity.getId());
            entity.setName(ecoEntity.getName());
            entity.setShortName(ecoEntity.getShortName());
            entity.setFullName(ecoEntity.getFullName());
            entity.setChiefName(ecoEntity.getChiefName());
            entity.setChiefPosition(ecoEntity.getChiefPosition());
            entity.setPhoneNumber(ecoEntity.getPhoneNumber());
            entity.setContactPerson(ecoEntity.getContactPerson());
            entity.setInn(ecoEntity.getInn());
            entity.setKpp(ecoEntity.getKpp());
            entity.setOgrn(ogrn.entrySet().stream().filter(entry -> Objects.equals(entry.getValue(), ecoEntity.getInn()))
                .map(Map.Entry::getKey).findFirst().orElse(""));
            entity.setInspectorName(ecoEntity.getInspectorName());
            entity.setInspectorHead(ecoEntity.getInspectorHead());
            entity.setLocation(ecoEntity.getLocation());
            entity.setNote(ecoEntity.getNote());
            entity.setFactualAddress(null);
            entity.setJuridicalAddress(ecoEntity.getLegalAddress());
            entity.setMailAddress(ecoEntity.getPostalAddress());

            List<CompanyType> companyTypeList = new ArrayList<>();
            CompanyType companyType = new CompanyType();
            companyType.setCompany(entity);
            companyType.setType(CompanyTypeEnum.Companion.getById(ecoEntity.getCompanyType()));
            companyTypeList.add(companyType);
            // Сверка с CONTRACTOR
            if (COMPANY_CONTRACTOR_REF.contains(ecoEntity.getId())) {
                CompanyType contractor = new CompanyType();
                contractor.setCompany(entity);
                contractor.setType(CompanyTypeEnum.PRODUCT_PRODUCER);
                companyTypeList.add(contractor);
            }
            entity.setCompanyTypeList(companyTypeList);
            return entity;
        }).collect(Collectors.toList());
        if (CollectionUtils.isNotEmpty(companyList)) {
            companyService.saveAll(companyList);
        }

        // Изготовители компонентов
        List<String> manufacturerList = new ArrayList<>();
        ecoBomComponentService.getAll().forEach(ecoEntity -> {
            String manufacturer = ecoEntity.getManufacturer();
            if (manufacturer != null && !manufacturerList.contains(manufacturer)) {
                manufacturerList.add(manufacturer);
            }
        });
        List<Company> componentCompanyList = manufacturerList.stream().map(manufacturer -> {
            Company entity = new Company();
            entity.setName(manufacturer);
            CompanyType type = new CompanyType();
            type.setCompany(entity);
            type.setType(CompanyTypeEnum.COMPONENT_PRODUCER);
            entity.getCompanyTypeList().add(type);
            return entity;
        }).collect(Collectors.toList());
        companyService.saveAll(componentCompanyList);

        em.createNativeQuery(SQL_ENABLE_FOREIGN_KEY_CHECKS).executeUpdate();
    }
}